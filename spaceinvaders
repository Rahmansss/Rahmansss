import os
import pygame


class Game:
    def __init__(self):
        pass

    def controls(self, ship, laser):
        keys = pygame.key.get_pressed()
        for event in pygame.event.get():
            if event.type == pygame.QUIT:
                pygame.quit()
            if keys[pygame.K_a]:
                ship.move_left()
            elif keys[pygame.K_d]:
                ship.move_right()
            if event.type == pygame.KEYDOWN:
                if event.key == pygame.K_SPACE:
                    ship.fire(laser)
                elif event.key == pygame.K_ESCAPE:
                    pygame.quit()

    def game_loop(self, ship, speed, background, screen, laser):
        pygame.init()
        pygame.display.set_caption("Spaceinvaders")
        clock = pygame.time.Clock()
        while True:
            self.controls(ship, laser)
            laser.move()
            r = pygame.Rect(ship.position, (150, 150))
            laser_r = pygame.Rect(laser.position, (40, 40))
            screen.blit(background, [0, 0])
            screen.blit(ship.ship_sprite, r)
            screen.blit(laser.laser_sprite, laser_r)
            pygame.display.update()
            clock.tick(speed)


class Setting:
    def __init__(self):
        self.screen_size = (1920, 1080)
        self.screen = pygame.display.set_mode(self.screen_size)
        self.background = pygame.image.load(os.path.join(os.getcwd(), r"pictures\back_image.png"))
        self.speed = 20


class Ship(pygame.sprite.Sprite):
    def __init__(self):
        pygame.sprite.Sprite.__init__(self)
        self.position = [810, 900]
        self.ship_sprite = pygame.image.load(os.path.join(os.getcwd(), r"pictures\space_ship1.png"))

    def move_left(self):
        if ship.position[0] > 0:
            self.position[0] = self.position[0] - 10

    def move_right(self):
        if ship.position[0] < settings.screen_size[0] - 150:
            self.position[0] = self.position[0] + 10

    def fire(self, laser):
        laser.position = [(self.position[0] + 55), (self.position[1])]


class Laser(pygame.sprite.Sprite):
    def __init__(self):
        pygame.sprite.Sprite.__init__(self)
        self.laser_sprite = pygame.image.load(os.path.join(os.getcwd(), r"pictures\laser.png"))
        self.laser_sprite = pygame.transform.scale(pygame.image.load(os.path.join(os.getcwd(), r"pictures\laser.png")),
                                                   (40, 50))
        self.position = [20000, 0]

    def move(self):
        self.position[1] -= 10


game = Game()
settings = Setting()
ship = Ship()
laser = Laser()

game.game_loop(ship, 60, settings.background, settings.screen, laser)
